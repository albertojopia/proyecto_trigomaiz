---
title: "Análisis de los datos de maiz y trigo"
author: "AJ"
date: "23-04-2021"
output:
  html_document: default
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# paquetes
library(rmarkdown)
library(tidyverse)
library(lubridate)
library(leaflet)
library(plotly)

# leer datos
ruta.datos<-"../datos"

```



Analisis prelimirar de datos de terreno en huertos de trigo y maiz de la localidad de villa baviera:

1. Datos de estacion meteorologica:
+ Radiacion solar, Temperatura, etc.
+ Humedad de suelo

1. Datos de muestras de vegetacion: 
+ Peso hoja, tallo, etc.


```{r leer datos, include=FALSE}
dir(ruta.datos, full.names = T) %>%
  read.csv(., sep=",", dec=".", skip = 2)%>%
  as_tibble()->datos.est.maiz

names(datos.est.maiz)
#4,5,12,13, 26, 27

datos.est.maiz %>% 
  mutate(Timestamps=ymd_hms(Timestamps))->puerto

# son muchos nombres, puertos y sensores, asi que separare los datos por puerto
puerto1<-puerto[, c(1:3, 6:11, 14:16)]  
puerto2<-puerto[,c(1,17:19)]  
puerto3<-puerto[,c(1,20:22)] 
puerto4<-puerto[,c(1,23:25)] 
puerto8<-puerto[,c(1,28:29)] 
  
puerto1 %>% mutate(puerto="puerto1") %>%
  gather(variables, valor, -Timestamps, -puerto)->puerto1

puerto2 %>% mutate(puerto="puerto2") %>%
  gather(variables, valor, -Timestamps, -puerto)->puerto2

puerto3 %>% mutate(puerto="puerto3") %>%
  gather(variables, valor, -Timestamps, -puerto)->puerto3

puerto4 %>% mutate(puerto="puerto4") %>%
  gather(variables, valor, -Timestamps, -puerto)->puerto4

puerto8 %>% mutate(puerto="puerto8") %>%
  gather(variables, valor, -Timestamps, -puerto)->puerto8

bind_rows(puerto1,puerto2,puerto3,puerto4,puerto8)->puertos

```
# Análisis Exploratorio de Datos {.tabset}
## Área de estudio {.tabset}

Se tienen dos predios experimentales de cultivos maíz y trigo localizados en la localidad de Villa Baviera

```{r map, echo=FALSE,fig.width=10,message=FALSE}
leaflet() %>%
  addTiles() %>%
   addMarkers(lng = -71.59060528989966,
              lat = -36.38356609961854) 
```


## Distribuciones {.tabset}

Comparación de las distribuciones de las variables de la estacion metereologicas ATMOS (puerto 1) y los sendores de humedad (puerto 2, 3 y 4)

### Puerto1

```{r, echo=FALSE, warning=FALSE,fig.width=10 }
puertos %>% 
  filter(puerto=="puerto1")%>%
  ggplot(.,aes(variables,valor)) + 
  geom_boxplot()+
  facet_wrap(~variables, scale="free")+
  theme_minimal()
```

### Puerto2

```{r, echo=FALSE, warning=FALSE,fig.width=10 }
puertos %>% 
  filter(puerto=="puerto2")%>%
  ggplot(.,aes(variables,valor)) + 
  geom_boxplot()+
  facet_wrap(~variables, scale="free")+
  theme_minimal()
```

### Puerto3

```{r, echo=FALSE, warning=FALSE,fig.width=10 }
puertos %>% 
  filter(puerto=="puerto3")%>% 
  ggplot(.,aes(variables,valor)) + 
  geom_boxplot()+
  facet_wrap(~variables, scale="free")+
  theme_minimal()
```

### Puerto4

```{r, echo=FALSE, warning=FALSE,fig.width=10 }
puertos %>% 
  filter(puerto=="puerto4")%>% 
  ggplot(.,aes(variables,valor)) + 
  geom_boxplot()+
  facet_wrap(~variables, scale="free")+
  theme_minimal()
```


## Series temporales {.tabset}

### Puerto1

```{r, echo=FALSE, warning=FALSE,fig.width=9, fig.height=15 }
puertos %>% 
  filter(puerto=="puerto1")%>%
  ggplot(.,aes(Timestamps ,valor)) + 
  geom_line()+
  facet_wrap(~variables, scale="free", ncol = 1)+
  theme_minimal()->p
  p<- ggplotly(p)
  p

```

### Puerto2

```{r, echo=FALSE, warning=FALSE,fig.width=9 }
puertos %>% 
  filter(puerto=="puerto2")%>%
  ggplot(.,aes(Timestamps ,valor)) + 
  geom_line()+
  facet_wrap(~variables, scale="free", ncol = 1)+
  theme_minimal()->p2
  p2<- ggplotly(p2)
  p2

```

### Puerto3

```{r, echo=FALSE, warning=FALSE,fig.width=9 }
puertos %>% 
  filter(puerto=="puerto3")%>%
  ggplot(.,aes(Timestamps ,valor)) + 
  geom_line()+
  facet_wrap(~variables, scale="free", ncol = 1)+
  theme_minimal()->p3
  p3<- ggplotly(p3)
  p3

```

### Puerto4

```{r, echo=FALSE, warning=FALSE,fig.width=9 }
puertos %>% 
  filter(puerto=="puerto4")%>%
  ggplot(.,aes(Timestamps ,valor)) + 
  geom_line()+
  facet_wrap(~variables, scale="free", ncol = 1)+
  theme_minimal()->p4
  p4<- ggplotly(p4)
  p4

```


